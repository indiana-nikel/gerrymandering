df_lmx <- df_lmx %>%
mutate("pred_lme" = predict(mixed_reg_2, df_lmx), "pred_lm" = predict(df_lin_reg, df_lmx))
df_lmx
df_team <- df_lmx %>% filter(teamID %in% c("ANA", "BOS", "CIN", "FLO", "HOU", "MIN", "SEA", "TOR", "WAS"))
lm_plot <- df_team %>%
ggplot(aes(x=H, y=R)) +
geom_point() +
geom_line(aes(y=pred_lme, color="blue")) +
geom_line(aes(y=pred_lm, color="red")) +
labs(title="LM Model\n9 Teams") +
facet_wrap(~teamID, ncol=3)
lm_plot
# Plotting
# LME/LM Plot
df_lmx <- df_lmx %>%
arrange(teamID) %>%
mutate("pred_lme" = predict(mixed_reg_2, df_lmx), "pred_lm" = predict(df_lin_reg, df_lmx))
df_lmx
df_team <- df_lmx %>% filter(teamID %in% c("ANA", "BOS", "CIN", "FLO", "HOU", "MIN", "SEA", "TOR", "WAS"))
lm_plot <- df_team %>%
ggplot(aes(x=H, y=R)) +
geom_point() +
geom_line(aes(y=pred_lme, color="blue")) +
geom_line(aes(y=pred_lm, color="red")) +
labs(title="LM Model\n9 Teams") +
facet_wrap(~teamID, ncol=3)
lm_plot
# Plotting
# LME/LM Plot
df_lmx <- df_lmx %>%
mutate("pred_lme" = predict(mixed_reg_2, df_lmx), "pred_lm" = predict(df_lin_reg, df_lmx))
df_lmx
df_team <- df_lmx %>% filter(teamID %in% c("ANA", "BOS", "CIN", "FLO", "HOU", "MIN", "SEA", "TOR", "WAS"))
lm_plot <- df_team %>%
ggplot(aes(x=H, y=R)) +
geom_point() +
geom_line(aes(y=pred_lme, color="blue")) +
geom_line(aes(y=pred_lm, color="red")) +
labs(title="LM Model\n9 Teams") +
facet_wrap(~teamID, ncol=3)
lm_plot
# Plotting
# LME/LM Plot
df_lmx <- df_lmx %>%
mutate("pred_lme" = predict(mixed_reg_2, df_lmx), "pred_lm" = predict(df_lin_reg, df_lmx))
df_lmx
df_team <- df_lmx %>% filter(teamID %in% c("ANA", "BOS", "CIN", "FLO", "HOU", "MIN", "SEA", "TOR", "WAS"))
lm_plot <- df_team %>%
ggplot(aes(x=H, y=R)) +
geom_point() +
geom_line(aes(y=pred_lme, color="blue")) +
geom_line(aes(y=pred_lm, color="red")) +
labs(title="LM Model\n9 Teams") +
facet_wrap(~teamID, ncol=3)
lm_plot
df_lmx <- df_lmx %>%
mutate("resid_lme" = R - pred_lme,"resid_lm" = R - pred_lm)
# LME Residuals
lme_resid_plot <- df_lmx %>%
ggplot(aes(pred_lme, resid_lme)) +
geom_point() +
xlab("Fitted Values") +
ylab("Residuals") +
labs(title="LMER Residuals")
lme_resid_plot
# LM Residuals
lm_resid_plot <- df_lmx %>%
ggplot(aes(pred_lm, resid_lm)) +
geom_point() +
xlab("Fitted Values") +
ylab("Residuals") +
labs(title="LM Residuals")
lm_resid_plot
# Plotting
# LME/LM Plot
df_lmx <- df_lmx %>%
mutate("pred_lme" = predict(mixed_reg_2, df_lmx), "pred_lm" = predict(df_lin_reg, df_lmx))
df_lmx
df_team <- df_lmx %>% filter(teamID %in% c("ANA", "BOS", "CIN", "FLO", "HOU", "MIN", "SEA", "TOR", "WAS"))
lm_plot <- df_team %>%
ggplot(aes(x=H, y=R)) +
geom_point() +
geom_line(aes(y=pred_lme, color="blue")) +
geom_line(aes(y=pred_lm, color="red")) +
labs(title="LMX Model\n9 Teams") +
facet_wrap(~teamID, ncol=3)
lm_plot
knitr::opts_chunk$set(echo = TRUE)
library(Lahman)
library(lme4)
library(tidyverse)
df <- Teams %>% filter(c(yearID >= 1990))
df_lme <- df %>% select(c(BB, H, R, teamID))
mixed_reg <- lmer(R ~ scale(BB) + scale(H) + (1 + scale(BB) | teamID), data=df_lme)
summary(mixed_reg)
covar <- sqrt(251.01)*sqrt(15.68)*(0.27)
print(paste("Covariance of randoms:", covar))
fitted_val <- fitted(mixed_reg)
resid <- df_lme$R - fitted_val
resid_df <- data.frame(fitted_val, resid)
plotted_resid <- resid_df %>%
ggplot(aes(fitted_val, resid)) +
geom_point() +
xlab("Fitted Values") +
ylab("Residuals") +
labs(title="LMER Residuals")
plotted_resid
# Data wrangling
df <- Teams %>% filter(c(yearID >= 1990))
df_lmx <- df %>% select(c(H, R, teamID))
# LME model
mixed_reg_2 <- lmer(R ~ scale(H) + (1 + scale(H) | teamID), data=df_lmx)
summary(mixed_reg_2)
# Linear regresson per team
df_lin_reg <- lmList(R ~ H | teamID, data=df_lmx)
# Plotting
# LME/LM Plot
df_lmx <- df_lmx %>%
mutate("pred_lme" = predict(mixed_reg_2, df_lmx), "pred_lm" = predict(df_lin_reg, df_lmx))
df_lmx
df_team <- df_lmx %>% filter(teamID %in% c("ANA", "BOS", "CIN", "FLO", "HOU", "MIN", "SEA", "TOR", "WAS"))
lm_plot <- df_team %>%
ggplot(aes(x=H, y=R)) +
geom_point() +
geom_line(aes(y=pred_lme, color="blue")) +
geom_line(aes(y=pred_lm, color="red")) +
labs(title="LMX Model\n9 Teams") +
facet_wrap(~teamID, ncol=3)
lm_plot
df_lmx <- df_lmx %>%
mutate("resid_lme" = R - pred_lme,"resid_lm" = R - pred_lm)
# LME Residuals
lme_resid_plot <- df_lmx %>%
ggplot(aes(pred_lme, resid_lme)) +
geom_point() +
xlab("Fitted Values") +
ylab("Residuals") +
labs(title="LMER Residuals")
lme_resid_plot
# LM Residuals
lm_resid_plot <- df_lmx %>%
ggplot(aes(pred_lm, resid_lm)) +
geom_point() +
xlab("Fitted Values") +
ylab("Residuals") +
labs(title="LM Residuals")
lm_resid_plot
df_lmx <- df_lmx %>% arrange(teamID)
df_lmx <- df_lmx %>%
mutate("resid_lme" = R - pred_lme,"resid_lm" = R - pred_lm)
# LME Residuals
lme_resid_plot <- df_lmx %>%
ggplot(aes(pred_lme, resid_lme)) +
geom_point() +
xlab("Fitted Values") +
ylab("Residuals") +
labs(title="LMER Residuals")
lme_resid_plot
# LM Residuals
lm_resid_plot <- df_lmx %>%
ggplot(aes(pred_lm, resid_lm)) +
geom_point() +
xlab("Fitted Values") +
ylab("Residuals") +
labs(title="LM Residuals")
lm_resid_plot
# Plotting
# LME/LM Plot
df_lmx <- df_lmx %>% arrange(teamID)
df_lmx <- df_lmx %>%
mutate("pred_lme" = predict(mixed_reg_2, df_lmx), "pred_lm" = predict(df_lin_reg, df_lmx))
df_lmx
df_team <- df_lmx %>% filter(teamID %in% c("ANA", "BOS", "CIN", "FLO", "HOU", "MIN", "SEA", "TOR", "WAS"))
lm_plot <- df_team %>%
ggplot(aes(x=H, y=R)) +
geom_point() +
geom_line(aes(y=pred_lme, color="blue")) +
geom_line(aes(y=pred_lm, color="red")) +
labs(title="LMX Model\n9 Teams") +
facet_wrap(~teamID, ncol=3)
lm_plot
knitr::opts_chunk$set(echo = TRUE)
library(Lahman)
library(lme4)
library(tidyverse)
df <- Teams %>% filter(c(yearID >= 1990))
df_lme <- df %>% select(c(BB, H, R, teamID))
mixed_reg <- lmer(R ~ scale(BB) + scale(H) + (1 + scale(BB) | teamID), data=df_lme)
summary(mixed_reg)
covar <- sqrt(251.01)*sqrt(15.68)*(0.27)
print(paste("Covariance of randoms:", covar))
fitted_val <- fitted(mixed_reg)
resid <- df_lme$R - fitted_val
resid_df <- data.frame(fitted_val, resid)
plotted_resid <- resid_df %>%
ggplot(aes(fitted_val, resid)) +
geom_point() +
xlab("Fitted Values") +
ylab("Residuals") +
labs(title="LMER Residuals")
plotted_resid
# Data wrangling
df <- Teams %>% filter(c(yearID >= 1990))
df_lmx <- df %>% select(c(H, R, teamID))
# LME model
mixed_reg_2 <- lmer(R ~ scale(H) + (1 + scale(H) | teamID), data=df_lmx)
summary(mixed_reg_2)
# Linear regresson per team
df_lin_reg <- lmList(R ~ H | teamID, data=df_lmx)
# Plotting
# LME/LM Plot
df_lmx <- df_lmx %>% arrange(teamID)
df_lmx <- df_lmx %>%
mutate("pred_lme" = predict(mixed_reg_2, df_lmx), "pred_lm" = predict(df_lin_reg, df_lmx))
df_lmx
df_team <- df_lmx %>% filter(teamID %in% c("ANA", "BOS", "CIN", "FLO", "HOU", "MIN", "SEA", "TOR", "WAS"))
lm_plot <- df_team %>%
ggplot(aes(x=H, y=R)) +
geom_point() +
geom_line(aes(y=pred_lme, color="blue")) +
geom_line(aes(y=pred_lm, color="red")) +
labs(title="LMX Model\n9 Teams") +
facet_wrap(~teamID, ncol=3)
lm_plot
df_lmx <- df_lmx %>%
mutate("resid_lme" = R - pred_lme,"resid_lm" = R - pred_lm)
# LME Residuals
lme_resid_plot <- df_lmx %>%
ggplot(aes(pred_lme, resid_lme)) +
geom_point() +
xlab("Fitted Values") +
ylab("Residuals") +
labs(title="LMER Residuals")
lme_resid_plot
# LM Residuals
lm_resid_plot <- df_lmx %>%
ggplot(aes(pred_lm, resid_lm)) +
geom_point() +
xlab("Fitted Values") +
ylab("Residuals") +
labs(title="LM Residuals")
lm_resid_plot
# Plotting
# LME/LM Plot
df_lmx <- df_lmx %>% arrange(teamID)
df_lmx <- df_lmx %>%
mutate("pred_lme" = predict(mixed_reg_2, df_lmx), "pred_lm" = predict(df_lin_reg, df_lmx))
df_team <- df_lmx %>% filter(teamID %in% c("ANA", "BOS", "CIN", "FLO", "HOU", "MIN", "SEA", "TOR", "WAS"))
lm_plot <- df_team %>%
ggplot(aes(x=H, y=R)) +
geom_point() +
geom_line(aes(y=pred_lme, color="blue", label="LME")) +
geom_line(aes(y=pred_lm, color="red")) +
labs(title="LMX Model\n9 Teams") +
facet_wrap(~teamID, ncol=3)
lm_plot
# Plotting
# LME/LM Plot
df_lmx <- df_lmx %>% arrange(teamID)
df_lmx <- df_lmx %>%
mutate("pred_lme" = predict(mixed_reg_2, df_lmx), "pred_lm" = predict(df_lin_reg, df_lmx))
df_team <- df_lmx %>% filter(teamID %in% c("ANA", "BOS", "CIN", "FLO", "HOU", "MIN", "SEA", "TOR", "WAS"))
lm_plot <- df_team %>%
ggplot(aes(x=H, y=R)) +
geom_point() +
geom_line(aes(y=pred_lme, label="LME")) +
geom_line(aes(y=pred_lm, color="red")) +
labs(title="LMX Model\n9 Teams") +
facet_wrap(~teamID, ncol=3)
lm_plot
# Plotting
# LME/LM Plot
df_lmx <- df_lmx %>% arrange(teamID)
df_lmx <- df_lmx %>%
mutate("pred_lme" = predict(mixed_reg_2, df_lmx), "pred_lm" = predict(df_lin_reg, df_lmx))
df_team <- df_lmx %>% filter(teamID %in% c("ANA", "BOS", "CIN", "FLO", "HOU", "MIN", "SEA", "TOR", "WAS"))
lm_plot <- df_team %>%
ggplot(aes(x=H, y=R)) +
geom_point() +
geom_line(aes(y=pred_lme, label="LME")) +
geom_line(aes(y=pred_lm, label="LM")) +
labs(title="LMX Model\n9 Teams") +
facet_wrap(~teamID, ncol=3)
lm_plot
# Plotting
# LME/LM Plot
df_lmx <- df_lmx %>% arrange(teamID)
df_lmx <- df_lmx %>%
mutate("pred_lme" = predict(mixed_reg_2, df_lmx), "pred_lm" = predict(df_lin_reg, df_lmx))
df_team <- df_lmx %>% filter(teamID %in% c("ANA", "BOS", "CIN", "FLO", "HOU", "MIN", "SEA", "TOR", "WAS"))
lm_plot <- df_team %>%
ggplot(aes(x=H, y=R)) +
geom_point() +
geom_line(aes(y=pred_lme, color="blue") +
geom_line(aes(y=pred_lm, color="red") +
scale_color_discrete(breaks=c("LME","LM")) +
labs(title="LMX Model\n9 Teams") +
facet_wrap(~teamID, ncol=3)
lm_plot
# Plotting
# LME/LM Plot
df_lmx <- df_lmx %>% arrange(teamID)
df_lmx <- df_lmx %>%
mutate("pred_lme" = predict(mixed_reg_2, df_lmx), "pred_lm" = predict(df_lin_reg, df_lmx))
df_team <- df_lmx %>% filter(teamID %in% c("ANA", "BOS", "CIN", "FLO", "HOU", "MIN", "SEA", "TOR", "WAS"))
lm_plot <- df_team %>%
ggplot(aes(x=H, y=R)) +
geom_point() +
geom_line(aes(y=pred_lme, color="blue")) +
geom_line(aes(y=pred_lm, color="red") +
scale_color_discrete(breaks=c("LME","LM")) +
labs(title="LMX Model\n9 Teams") +
facet_wrap(~teamID, ncol=3)
lm_plot
# Plotting
# LME/LM Plot
df_lmx <- df_lmx %>% arrange(teamID)
df_lmx <- df_lmx %>%
mutate("pred_lme" = predict(mixed_reg_2, df_lmx), "pred_lm" = predict(df_lin_reg, df_lmx))
df_team <- df_lmx %>% filter(teamID %in% c("ANA", "BOS", "CIN", "FLO", "HOU", "MIN", "SEA", "TOR", "WAS"))
lm_plot <- df_team %>%
ggplot(aes(x=H, y=R)) +
geom_point() +
geom_line(aes(y=pred_lme, color="blue")) +
geom_line(aes(y=pred_lm, color="red")) +
scale_color_discrete(breaks=c("LME","LM")) +
labs(title="LMX Model\n9 Teams") +
facet_wrap(~teamID, ncol=3)
lm_plot
# Plotting
# LME/LM Plot
df_lmx <- df_lmx %>% arrange(teamID)
df_lmx <- df_lmx %>%
mutate("pred_lme" = predict(mixed_reg_2, df_lmx), "pred_lm" = predict(df_lin_reg, df_lmx))
df_team <- df_lmx %>% filter(teamID %in% c("ANA", "BOS", "CIN", "FLO", "HOU", "MIN", "SEA", "TOR", "WAS"))
lm_plot <- df_team %>%
ggplot(aes(x=H, y=R)) +
geom_point() +
geom_line(aes(y=pred_lme, color="blue")) +
geom_line(aes(y=pred_lm, color="red")) +
bp + scale_fill_manual(values=c("blue", "red"),
name="Models",
labels=c("LME", "LM")) +
labs(title="LMX Model\n9 Teams") +
facet_wrap(~teamID, ncol=3)
# Plotting
# LME/LM Plot
df_lmx <- df_lmx %>% arrange(teamID)
df_lmx <- df_lmx %>%
mutate("pred_lme" = predict(mixed_reg_2, df_lmx), "pred_lm" = predict(df_lin_reg, df_lmx))
df_team <- df_lmx %>% filter(teamID %in% c("ANA", "BOS", "CIN", "FLO", "HOU", "MIN", "SEA", "TOR", "WAS"))
lm_plot <- df_team %>%
ggplot(aes(x=H, y=R)) +
geom_point() +
geom_line(aes(y=pred_lme, color="blue")) +
geom_line(aes(y=pred_lm, color="red")) +
scale_fill_manual(values=c("blue", "red"),
name="Models",
labels=c("LME", "LM")) +
labs(title="LMX Model\n9 Teams") +
facet_wrap(~teamID, ncol=3)
lm_plot
# Plotting
# LME/LM Plot
df_lmx <- df_lmx %>% arrange(teamID)
df_lmx <- df_lmx %>%
mutate("pred_lme" = predict(mixed_reg_2, df_lmx), "pred_lm" = predict(df_lin_reg, df_lmx))
df_team <- df_lmx %>% filter(teamID %in% c("ANA", "BOS", "CIN", "FLO", "HOU", "MIN", "SEA", "TOR", "WAS"))
lm_plot <- df_team %>%
ggplot(aes(x=H, y=R)) +
geom_point() +
geom_line(aes(y=pred_lme, color="blue")) +
geom_line(aes(y=pred_lm, color="red")) +
scale_color_manual(values=c("blue", "red"),
name="Models",
breaks=c(),
labels=c("LME", "LM")) +
labs(title="LMX Model\n9 Teams") +
facet_wrap(~teamID, ncol=3)
lm_plot
# Plotting
# LME/LM Plot
df_lmx <- df_lmx %>% arrange(teamID)
df_lmx <- df_lmx %>%
mutate("pred_lme" = predict(mixed_reg_2, df_lmx), "pred_lm" = predict(df_lin_reg, df_lmx))
df_team <- df_lmx %>% filter(teamID %in% c("ANA", "BOS", "CIN", "FLO", "HOU", "MIN", "SEA", "TOR", "WAS"))
lm_plot <- df_team %>%
ggplot(aes(x=H, y=R)) +
geom_point() +
geom_line(aes(y=pred_lme, color="blue")) +
geom_line(aes(y=pred_lm, color="red")) +
scale_color_manual(values=c("blue", "red"),
name="Models",
#breaks=c(),
labels=c("LME", "LM")) +
labs(title="LMX Model\n9 Teams") +
facet_wrap(~teamID, ncol=3)
lm_plot
# Plotting
# LME/LM Plot
df_lmx <- df_lmx %>% arrange(teamID)
df_lmx <- df_lmx %>%
mutate("pred_lme" = predict(mixed_reg_2, df_lmx), "pred_lm" = predict(df_lin_reg, df_lmx))
df_team <- df_lmx %>% filter(teamID %in% c("ANA", "BOS", "CIN", "FLO", "HOU", "MIN", "SEA", "TOR", "WAS"))
lm_plot <- df_team %>%
ggplot(aes(x=H, y=R)) +
geom_point() +
geom_line(aes(y=pred_lme, color="blue")) +
geom_line(aes(y=pred_lm, color="red")) +
scale_color_manual(values=c("blue", "red"),
name="Models",
labels=c("LME", "LM")) +
labs(title="LMX Model\n9 Teams") +
facet_wrap(~teamID, ncol=3)
lm_plot
fitted_val <- fitted(mixed_reg)
resid <- df_lme$R - fitted_val
resid_df <- data.frame(fitted_val, resid)
plotted_resid <- resid_df %>%
ggplot(aes(fitted_val, resid)) +
geom_point() +
geom_hline() +
xlab("Fitted Values") +
ylab("Residuals") +
labs(title="LMER Residuals")
plotted_resid
fitted_val <- fitted(mixed_reg)
resid <- df_lme$R - fitted_val
resid_df <- data.frame(fitted_val, resid)
plotted_resid <- resid_df %>%
ggplot(aes(fitted_val, resid)) +
geom_point() +
geom_hline(yintercept=0) +
xlab("Fitted Values") +
ylab("Residuals") +
labs(title="LMER Residuals")
plotted_resid
fitted_val <- fitted(mixed_reg)
resid <- df_lme$R - fitted_val
resid_df <- data.frame(fitted_val, resid)
plotted_resid <- resid_df %>%
ggplot(aes(fitted_val, resid)) +
geom_point() +
geom_hline(yintercept=0, color = "red") +
xlab("Fitted Values") +
ylab("Residuals") +
labs(title="LMER Residuals")
plotted_resid
df_lmx <- df_lmx %>%
mutate("resid_lme" = R - pred_lme,"resid_lm" = R - pred_lm)
# LME Residuals
lme_resid_plot <- df_lmx %>%
ggplot(aes(pred_lme, resid_lme)) +
geom_point() +
geom_hline(yintercept = 0, color = "red") +
xlab("Fitted Values") +
ylab("Residuals") +
labs(title="LMER Residuals")
lme_resid_plot
# LM Residuals
lm_resid_plot <- df_lmx %>%
ggplot(aes(pred_lm, resid_lm)) +
geom_point() +
geom_hline(yintercept = 0, color = "red") +
xlab("Fitted Values") +
ylab("Residuals") +
labs(title="LM Residuals")
lm_resid_plot
df_lmx <- df_lmx %>%
mutate("resid_lme" = R - pred_lme,"resid_lm" = R - pred_lm)
# LME Residuals
lme_resid_plot <- df_lmx %>%
ggplot(aes(pred_lme, resid_lme)) +
geom_point() +
geom_hline(yintercept = 0, color = "red") +
xlab("Fitted Values") +
ylab("Residuals") +
labs(title="LME Residuals")
lme_resid_plot
# LM Residuals
lm_resid_plot <- df_lmx %>%
ggplot(aes(pred_lm, resid_lm)) +
geom_point() +
geom_hline(yintercept = 0, color = "red") +
xlab("Fitted Values") +
ylab("Residuals") +
labs(title="LM Residuals")
lm_resid_plot
ggplot(map_data("world")) +
geom_polygon(aes(x = long, y = lat, group = group, fill = region)) +
guides(fill = FALSE)
library(tidyverse)
ggplot(map_data("world")) +
geom_polygon(aes(x = long, y = lat, group = group, fill = region)) +
guides(fill = FALSE)
ggplot(map_data("states")) +
geom_polygon(aes(x = long, y = lat, group = group, fill = region)) +
guides(fill = FALSE)
ggplot(map_data("state")) +
geom_polygon(aes(x = long, y = lat, group = group, fill = region)) +
guides(fill = FALSE)
shiny::runApp('mds_repo/Map')
runApp('mds_repo/Map')
runApp('mds_repo/Map')
map_data("state")
map_data("state")$region
map_data("state") %>% filter(region="colorado")
map_data("state") %>% filter(region=="colorado")
shiny::runApp('mds_repo/labs/DSCI_532_milestone2_inikel/USA_Map')
runApp('mds_repo/labs/DSCI_532_milestone2_inikel/USA_Map')
runApp('mds_repo/labs/DSCI_532_milestone2_inikel/USA_Map')
runApp('mds_repo/labs/DSCI_532_milestone2_inikel/USA_Map')
